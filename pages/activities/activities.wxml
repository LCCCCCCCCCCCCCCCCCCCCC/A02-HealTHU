<!--pages/activities/activities.wxml-->
<!-- page-meta 只能是页面内的第一个节点 -->
<page-meta page-style="{{ show ? 'overflow: hidden;' : '' }}" />
<van-nav-bar
  right-text="发起"
  safe-area-inset-top="{{false}}"
  fixed="{{true}}"
  placeholder="{{true}}"
  bind:click-right="onClickRight">
  <view slot="title">
    <van-search
      value="{{ value }}"
      placeholder="请输入搜索关键词"
      use-action-slot
      bind:change="onChange"
      bind:search="onSearch"
    >
      <view slot="action" bind:tap="onClick">搜索</view>
    </van-search> 
  </view>
</van-nav-bar>
<van-tabs active="{{ active }}" bind:change="onactiveChange">
<van-tab title="关注">
  <van-empty description="关注的人还没有参加过活动"></van-empty>
</van-tab>

  <van-tab title="活动">
  <view wx:for="{{activities2}}" wx:key="index">
  <!-- <view wx:for="{{activities}}" wx:key="index"> -->
    <van-card 
    desc="({{item.promoter}}发起，共{{item.participantNum}}人报名，预计参与人数{{item.partNumMin}}-{{item.partNumMax}}，{{item.date}} {{item.start}}-{{item.end}}) {{item.label}}"
    title="{{item.title}}"
    thumb="../images/swiper2.jpg"
    url='./activity/activity'
    >
    <view slot="tags">
      <van-tag plain type="danger" wx:if="{{item.state == 1}}">已结束</van-tag>
        <span wx:for="{{item.tags}}">
          <van-tag plain type="primary">{{item}}</van-tag>
        </span>
      </view>
      <view slot="footer">
        <van-button size="mini" bind:click="showdetail" data-index="{{index}}">查看</van-button>
        <van-button size="mini" bind:click="signup" wx:if="{{item.state == 0}}">报名</van-button>
      </view>
    </van-card>
  </view>
</van-tab>

<van-tab title="我的">
  <view wx:for="{{activities3}}" wx:key="index">
    <van-card 
    desc="({{item.promoter}}发起，共{{item.participantNum}}人报名，预计参与人数{{item.partNumMin}}-{{item.partNumMax}}，{{item.date}} {{item.start}}-{{item.end}}) {{item.label}}"
    title="{{item.title}}"
    thumb="../images/swiper2.jpg"
    url='./activity/activity'
    >
    <view slot="tags">
      <van-tag plain type="danger" wx:if="{{item.state == 1}}">已结束</van-tag>
        <span wx:for="{{item.tags}}">
          <van-tag plain type="primary">{{item}}</van-tag>
        </span>
    </view>
    <view slot="footer">
      <van-button size="mini" bind:click="showdetail" data-index="{{index}}">查看</van-button>
      <van-button size="mini" bind:click="handleReview" data-index="{{index}}" wx:if="{{item.state == 0}}">报名审核</van-button>
    </view>
    </van-card>
  </view>
</van-tab>

<van-dialog
  use-slot
  title="报名信息填写"
  show="{{ signshow }}"
  show-cancel-button
  confirm-button-open-type="getUserInfo"
  bind:close="onsignClose"
  bind:getuserinfo="signupConfirm"
>
  <van-cell-group class="toflex">
    <textarea class="textinput"
      bindinput="handleSignInput" placeholder="请填写相关信息"></textarea>
  </van-cell-group>
</van-dialog>

<van-dialog
  use-slot
  title="活动报名审核"
  show="{{ reviewshow }}"
>
  <van-cell-group inset wx:for="{{reviewList}}" wx:key="index">
    <van-cell title="{{item.nickname}}" label="{{item.text}}">
      <van-button wx:if="{{item.state == 0}}" size="mini" bind:click="agreeHandle" data-index="{{index}}">接受</van-button>
      <van-button wx:if="{{item.state == 0}}" size="mini" bind:click="rejectHandle" data-index="{{index}}">拒绝</van-button>
      <van-button disabled size="mini" wx:if="{{item.state == 1}}">已接受</van-button>
      <van-button disabled size="mini" wx:if="{{item.state == 2}}">已拒绝</van-button>
    </van-cell>
  </van-cell-group>
</van-dialog>
</van-tabs>
