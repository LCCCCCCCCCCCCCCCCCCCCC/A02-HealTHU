## HealTHU 软件需求规格说明

|日期|版本|说明|作者|
|----|----|----|----|
|2023-10-25|1.0|初稿定稿|张梦遥、黎畅|
|2023-11-7|2.0|主题修改后定稿|黎畅|
|2024-1-3|2.1|根据软件实际，补充使用说明|张梦遥、黎畅|

[TOC]

### 1. 简介

产品名称为“HealTHU”，定位为可多人交互、基于时间规划与数据监测的健康生活规划平台。该软件将帮助学生规划日程，发起和参与多人活动，并提供用户间互动交流的论坛。

该软件主要在清华大学内部使用，学生可以在该软件中绑定自己的清华大学信息门户身份，同步课程安排等相关信息。

### 2. 综合描述

#### 2.1	用户特征

该产品面向的用户主要为有健康生活规划需求的清华大学学生。以下是有代表性的用户群体特征（单个用户不一定只拥有一种特征）：
1. 有日程规划需求：清华学生需要处理日常生活中的课程、作业、集体活动等诸多事项，时间管理非常重要。软件提供了日程规划功能，并能够通过清华信息门户账号同步课程表、网络学堂作业截止日期等信息，通过微信消息推送，给予用户及时的提醒；软件也支持多人活动的发起、报名等，并能够同步至日程规划。
2. 健康意识较高：这部分学生希望在清华的学业与诸多压力下保持健康的生活方式，有一定的健康生活意愿。对于这类群体，软件为其提供记录和总结功能，可以起到系统性的监督作用，提供正反馈，让用户保持良好生活习惯。
3. 有社交需求：用户喜欢参与讨论、回复帖子，乐于与校内同学分享经验、观点和问题，愿意通过社区与校内同学建立联系和扩展社交圈。这类用户在时间规划的同时，可以以发起、参与多人活动为契机，增进与其他清华学生的感情。

#### 2.2 同类软件分析

随着生活节奏的加快和工作学习压力的增大，日程管理类软件可以帮助用户高效地安排时间、管理任务、提醒重要事项。目前的日程管理类软件可以被个人用户用于管理个人日程安排、提醒工作和生活中的重要事件，也可以被企业用户用于协调团队的工作任务、安排会议和制定计划，总结如下：

1. 移动端设备通常自带单一的日程提醒功能（如“手机日历”），由于设备差异，难以在多用户之间实现同步，仅能用于单人性日程。
2. 目前已有的“待办”“日历”类软件补充了时间统计、多端同步等功能，但仍局限于单人使用，且新功能通常需要付费以解锁使用。
3. 企业办公软件（如“企业微信”、“飞书”）通常自带简单的日程管理模块，能够为多人安排预定的会议日程。但与清华学生的应用需求不完全相符，且学生之间不具有“企业关系”或“上下级关系”，也难以为多人活动特意使用企业办公软件、建立“企业组织”。


#### 2.3 一般性限制

1. 项目需要在2023年11月9日进行中期汇报，2024年1月4日前完成验收。
2. 项目发起方提供的服务器性能。
3. 使用 https://github.com/thu-info-community/thu-info-lib 提供的清华大学信息门户相关接口，遵循上述项目的MIT License 开源。

#### 2.4	假设和依赖

1. 项目发起方能参与需求核准工作。
2. 考虑到清华大学本科生每届约3500人，系统实际用户数量不超过15000人。
3. 对于小程序用户，微信版本需要 8.0.0 以上（2021.01.25更新版本）；用户需要有稳定的网络连接才能正常使用该软件。
4. 可使用清华大学信息门户的部分接口，以及部分清华大学的宣传元素。

### 3.	详细需求
软件核心功能展示如下：

<image src="./assert_temp/function.png"/>

#### 3.1	功能需求
##### 3.1.1	用户认证和账号管理
1. 注册与登录与微信账号绑定，用户首次登录后生成一个唯一的uid。
2. 使用 cookies、jwt 保留用户的登录状态，确保用户身份安全和数据隐私。

##### 3.1.2	主页
1. 展示今日事务，并随时间更新，在事务开始及结束时通过**微信消息推送**（提醒可以手动关闭），提醒用户；展示近期截止日期提醒。

<image src="./assert_temp/todo-ddl.png" width=200 />

2. 日程规划入口（“管理”）：查看单日的所有日程及其完成情况，**点击日期提供快速日期跳转**，可以添加不同类型的事务（“+”按钮，类型分为ddl、活动、课程、运动、饮食），**点击事项跳转至编辑界面**。

<image src="./assert_temp/todo.png" width=200 />

3. 睡眠入口：手动记录睡眠情况，并统计分析睡眠质量。
3. 运动入口：筛选当日用户运动相关日程进行展示，并展示场馆预约信息，及跳转到场馆预约页面。
4. 活动入口：见3.1.3节。
5. 统计入口：浏览先前的日程完成情况总结。
6. 成就入口：浏览个人已达成的成就（对应徽章由灰色变为彩色）及达成时间，未达成成就的进度。

##### 3.1.3 活动

活动的加入会自动将事件同步在时间规划中。

1. 预览活动，点击可进入对应的活动界面。可根据日期范围对活动进行筛选。可仅展示关注者发起或参与的活动。
2. 报名活动入口。
3. 发起活动入口，支持图文信息。能够编辑自己发起的活动（不支持时间修改），以及删除活动，审核报名申请。
4. 活动结束后参与人可以对发起人进行评价。

##### 3.1.4	社区
1. 预览帖子，点击可进入对应帖子界面。可根据热度、发帖时间进行排序，可仅展示关注者的帖子。帖子界面中可点赞、评论、删除（仅发布者）。
2. 发帖入口（“+”按钮），支持图文信息。
3. 消息入口，浏览账号接收到的回复、活动报名等消息，按时间排序，支持筛选未查看的消息。
4. 搜索栏：可通过关键字搜索帖子标题或用户，支持跳转到对应帖子或用户。

##### 3.1.5	我的
1. 显示头像、id、昵称、签名，提供个人信息修改入口。

<image src="./assert_temp/infochange.png" width=200 />

2. 个人主页入口（显示个人信息、成就、最近发帖和活动），关注列表、粉丝列表入口（快速关注、取关及访问对应个人主页）。
3. 清华身份绑定入口。
4. 隐私权限修改入口。

<image src="./assert_temp/privacy.png" width=200 />

5. 帮助和反馈入口，用于向项目运维方提出疑问，提交建议反馈。
6. 退出登录。

#### 3.2	外部接口需求
1. 应当利用清华大学信息门户的相关接口（参考https://github.com/thu-info-community/thu-info-lib）。
2. 应当与微信小程序的 API 实现对接，完成获取用户微信账号相关信息、向用户推送微信小程序消息等功能。

#### 3.3	性能需求
1. 系统应同时支持 1000 人同时在线使用。
2. 小程序启动时加载时间应小于5s，常用界面加载或响应时间应不超过 1s。
3. 后端服务器应当保证在每秒 500 次网络请求和 200 次数据库 IO 的情况下能够稳定运行和及时处理请求，请求处理延迟不超过 1000ms。

#### 3.4	质量属性
1.	界面应支持不同设备和屏幕尺寸的适配，包括手机、平板电脑。
2.	易用性：用户界面应简洁、直观，易于导航和使用。
3.	安全性：前后端通信对于敏感信息（清华信息门户账号等）进行加密，防止信息泄露；后端数据库存储密码及个人敏感信息应加密，仅用户和授权人员可访问；后端数据库不向外直接暴露端口。 
4.	鲁棒性：前端和后端都应分别检查用户输入的合法性，并在非法输入的情况下服务不崩溃，向用户说明错误信息。

### 4.	用户故事
#### 4.1	用户故事地图与用户故事卡
<image src="./assert_temp/storymap.png" />

#### 4.2	各功能点优先级和难度

- 用户个人可以注册并登录账号，查看并修改个人信息
优先级：高；技术实现难度：低
- 用户个人可以将信息与清华学生身份绑定，绑定后可以自动获取体测成绩等资料和体育运动相关信息
优先级：中；技术实现难度：高
- 用户可以在个人界面查询关注列表、粉丝列表，并在其他界面能够聚焦关注用户相关信息，通过点击用户头像进入个人主页
优先级：低；技术实现难度：中
- 用户可以手动选择开始运动/睡眠让程序记录，软件动态更新任务完成情况，并提供昨日的总结报告
优先级：高；技术实现难度：高
- 用户可以查看完成情况的历史记录，完成一些阶段性目标可以获得成就徽章，用户可以设置徽章的展示情况
优先级：高；技术实现难度：中
- 用户可以在社区页面对帖子进行浏览、发布、回复等操作，可以设置浏览帖子的优先级与屏蔽等操作，同时可以在社区中对用户进行关注、屏蔽等操作
优先级：中；技术实现难度：中
- 用户可以通过消息按钮跳转到接收消息，接受到的消息如果是新消息会标识，帖子中的回复与点赞消息可以跳转到帖子相应位置，私聊消息进入私聊页面
优先级：低；技术实现难度：高

### 5.	架构和技术选型
本项目是一款微信小程序，采用前后端分离的总体架构。 
前端：微信提供的小程序部署，使用语言 wxml, wxss, JavaScript。 
后端：Django 框架，数据库 MySQL，使用docker容器healthu进行部署，使用nginx进行反向代理，利用uwsgi进行项目的启动以及相关日志输出。

### 6.	项目开发与分工
#### 6.1	项目的开发迭代计划
|轮次|	周次|	任务|
|----|----|----|
|第一轮|	第6-7周	|搭建前后端环境，完成用户的注册与登录
|第二轮|	第8周	|实现对用户个人信息的管理，关注功能
|第三轮|	第9-10周	|前后端对接，发布版本1
|第四轮|	第11周	|搭建基础论坛，实现好友功能
|第五轮|	第12周	|实现个人消息提醒、接入外部推送等功能，发布版本2
|第六轮|	第13周	|完善各个功能的实现，解决bug，设计和实现额外功能
|第七轮|	第14周	|设计使用教程，完善文档，发布版本3
|第八轮|    第15-16周|完善测试，进行汇报和验收

#### 6.2	分工

- 原型设计：牛放、陈者霖
- 前端：张梦遥、黎畅
- 后端：牛放、陈者霖
- 会议组织与进度统筹：黎畅
- 相关文档：张梦遥、黎畅

原型链接：
https://modao.cc/proto/oe9cRDys32h1fuKIwb5W/sharing?view_mode=device&screen=rbpTtfUDFGPkBkRlU&canvasId=rcTtfn3gYw7mnCVR

### 7.	支持信息

**定义、缩写词以及简写：**

楼层（用于社区功能）：帖子的第n层指该帖子的第n-1条回复（不含发帖内容），楼层号为1对应发帖的正文内容。这一说法源于早期互联网论坛交流时，每个帖子的每条回复都有唯一的数字标识，数字大小随时间戳顺序递增。

体质测试：教育部印发《国家学生体质健康标准(2014年修订)》，要求各学校每学年开展覆盖本校各年级学生的《标准》测试工作。大学生需要完成以下测试：身高、体重、肺活量、50米跑、立定跳远、坐位体前屈、引体向上(男生)或仰卧起坐(女生)、1000m(男生)或800m(女生)长跑。 

体育场馆预约：“清华大学信息门户-校园生活-体育场馆预约”提供校内体育场地的分时段预约，需要付费，每日8:00开放第4天场地预约。
